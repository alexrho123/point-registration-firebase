<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Î Î¯Î½Î±ÎºÎ±Ï‚ Î”Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ·Ï‚</title>
  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet"/>
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        fontFamily: { sans: ['Inter','ui-sans-serif','system-ui'] },
        extend: {
          colors: {
            primary: { DEFAULT:'#4f46e5', light:'#6366f1', dark:'#4338ca' },
            accent:  { DEFAULT:'#f59e0b', light:'#fbbf24', dark:'#d97706' },
            region:'#8b5cf6', danger:'#dc2626', success:'#16a34a', softbg:'#f8fafc', glass:'rgba(255,255,255,0.6)'
          },
          boxShadow: { strong:'0 10px 15px -3px rgba(0,0,0,0.1),0 4px 6px -2px rgba(0,0,0,0.05)' },
          borderRadius: { xl:'1.5rem','2xl':'2rem' }
        }
      },
      plugins:[function({addUtilities}){ addUtilities({'.backdrop-glass':{'backdrop-filter':'blur(10px)'}}) }]
    };
  </script>
  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
</head>
<body class="bg-softbg font-sans text-darktext min-h-screen flex flex-col items-center">

  <!-- Login Modal -->
  <div id="loginModal" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50">
    <div class="bg-white rounded-2xl p-8 shadow-strong w-full max-w-md relative">
      <button onclick="document.getElementById('loginModal').classList.add('hidden')" class="absolute top-3 right-3 text-gray-500 hover:text-gray-700">âœ•</button>
      <h2 class="text-2xl font-semibold text-primary mb-4 text-center">Î£ÏÎ½Î´ÎµÏƒÎ· Î”Î¹Î±Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î®</h2>
      <form id="loginForm" class="space-y-4">
        <input id="loginUsername" type="text" placeholder="ÎŒÎ½Î¿Î¼Î± Ï‡ÏÎ®ÏƒÏ„Î·" required class="w-full px-4 py-2 border rounded-lg"/>
        <input id="loginPassword" type="password" placeholder="ÎšÏ‰Î´Î¹ÎºÏŒÏ‚" required class="w-full px-4 py-2 border rounded-lg"/>
        <button type="submit" class="w-full bg-primary text-white py-2 rounded-xl">Î£ÏÎ½Î´ÎµÏƒÎ·</button>
      </form>
    </div>
  </div>

  <!-- Admin Panel -->
  <div id="appContent" class="hidden w-full max-w-6xl flex flex-col flex-1">
    <!-- Navbar -->
    <nav class="w-full bg-white shadow px-6 py-4 flex justify-between items-center">
      <h1 class="text-3xl font-bold text-primary">Î Î¯Î½Î±ÎºÎ±Ï‚ Î”Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ·Ï‚</h1>
      <button id="logoutBtn" class="bg-danger text-white px-4 py-2 rounded-xl">Î‘Ï€Î¿ÏƒÏÎ½Î´ÎµÏƒÎ·</button>
    </nav>
    <!-- Tabs -->
    <div class="w-full bg-white px-6">
      <ul id="tabs" class="flex space-x-4 border-b">
        <li data-tab="users" class="py-2 cursor-pointer hover:text-primary">Î§ÏÎ®ÏƒÏ„ÎµÏ‚</li>
        <li data-tab="products" class="py-2 cursor-pointer hover:text-primary">Î ÏÎ¿ÏŠÏŒÎ½Ï„Î±</li>
        <li data-tab="points" class="py-2 cursor-pointer hover:text-primary">Î£Î·Î¼ÎµÎ¯Î±</li>
        <li data-tab="orders" class="py-2 cursor-pointer hover:text-primary">Î Î±ÏÎ±Î³Î³ÎµÎ»Î¯ÎµÏ‚</li>
      </ul>
    </div>
    <main class="flex-1 overflow-auto p-6 bg-softbg">
      <!-- Users -->
      <section id="users" class="tab-content hidden flex flex-col items-center">
        <button id="addUserBtn" class="mb-4 bg-success text-white px-4 py-2 rounded-xl">Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· Î§ÏÎ®ÏƒÏ„Î·</button>
        <div id="usersContainer" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 w-full"></div>
      </section>
      <!-- Products -->
      <section id="products" class="tab-content hidden flex flex-col items-center">
        <button id="addProductBtn" class="mb-4 bg-success text-white px-4 py-2 rounded-xl">Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· Î ÏÎ¿ÏŠÏŒÎ½Ï„Î¿Ï‚</button>
        <div id="productsContainer" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 w-full"></div>
      </section>
      <!-- Points -->
      <section id="points" class="tab-content hidden flex flex-col items-center">
        <div id="pointsContainer" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 w-full"></div>
      </section>
      <!-- Orders -->
      <section id="orders" class="tab-content hidden flex flex-col items-center">
        <table class="w-full bg-white rounded-2xl shadow-strong overflow-hidden">
          <thead class="bg-primary text-white">
            <tr><th class="px-4 py-2">Î£Î·Î¼ÎµÎ¯Î¿</th><th class="px-4 py-2">Î£ÏÎ½Î¿Î»Î¿ (â‚¬)</th><th class="px-4 py-2">ÎÏÎ±</th><th class="px-4 py-2">Î”Î¹Î±Î³ÏÎ±Ï†</th><th>Î•Ï€ÎµÎ¾.</th><th>Î•ÎºÏ„Î­Î».</th></tr>
          </thead>
          <tbody id="ordersTable"></tbody>
        </table>
      </section>
    </main>
  </div>

  <!-- Modals -->
  <div id="userModal" class="fixed inset-0 bg-black/50 hidden items-center justify-center z-50">
    <div class="bg-white rounded-2xl p-6 shadow-strong w-full max-w-md relative">
      <button onclick="closeModal('userModal')" class="absolute top-3 right-3 text-gray-500 hover:text-gray-700">âœ•</button>
      <h3 class="text-xl font-semibold mb-4 text-center">ÎÎ­Î¿Ï‚ Î§ÏÎ®ÏƒÏ„Î·Ï‚</h3>
      <form id="userForm" class="space-y-3">
        <input id="userName" placeholder="ÎŒÎ½Î¿Î¼Î±" required class="w-full px-3 py-2 border rounded-lg"/>
        <input id="userUsername" placeholder="Username" required class="w-full px-3 py-2 border rounded-lg"/>
        <input id="userPass" type="password" placeholder="ÎšÏ‰Î´Î¹ÎºÏŒÏ‚" required class="w-full px-3 py-2 border rounded-lg"/>
        <button type="submit" class="w-full bg-primary text-white py-2 rounded-xl">Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·</button>
      </form>
    </div>
  </div>
  <div id="productModal" class="fixed inset-0 bg-black/50 hidden items-center justify-center z-50">
    <div class="bg-white rounded-2xl p-6 shadow-strong w-full max-w-md relative">
      <button onclick="closeModal('productModal')" class="absolute top-3 right-3 text-gray-500 hover:text-gray-700">âœ•</button>
      <h3 class="text-xl font-semibold mb-4 text-center">ÎÎ­Î¿ Î ÏÎ¿ÏŠÏŒÎ½</h3>
      <form id="productForm" class="space-y-3">
        <input id="productNameInput" placeholder="ÎŒÎ½Î¿Î¼Î±" required class="w-full px-3 py-2 border rounded-lg"/>
        <input id="productPriceInput" type="number" placeholder="Î¤Î¹Î¼Î®" required class="w-full px-3 py-2 border rounded-lg"/>
        <button type="submit" class="w-full bg-primary text-white py-2 rounded-xl">Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·</button>
      </form>
    </div>
  </div>
  <div id="pointModal" class="fixed inset-0 bg-black/50 hidden items-center justify-center z-50">
    <div class="bg-white rounded-2xl p-6 shadow-strong w-full max-w-md relative">
      <button onclick="closeModal('pointModal')" class="absolute top-3 right-3 text-gray-500 hover:text-gray-700">âœ•</button>
      <h3 class="text-xl font-semibold mb-4 text-center">Î•Ï€ÎµÎ¾ÎµÏÎ³Î±ÏƒÎ¯Î± Î£Î·Î¼ÎµÎ¯Î¿Ï…</h3>
      <form id="pointForm" class="space-y-3">
        <input id="pointNameInput" placeholder="ÎŒÎ½Î¿Î¼Î±" required class="w-full px-3 py-2 border rounded-lg"/>
        <select id="pointAreaInput" class="w-full px-3 py-2 border rounded-lg">
          <option>Î ÏŒÎ»Î·</option><option>Î™Î±Î»Ï…ÏƒÏŒÏ‚</option><option>Î¦Î±Î»Î·ÏÎ¬ÎºÎ¹</option><option>ÎšÎ¿Î»ÏÎ¼Ï€Î¹Î±</option><option>ÎÏŒÏ„Î¹Î± Î¡ÏŒÎ´Î¿Ï‚</option><option>Î”Ï…Ï„Î¹ÎºÎ® Î¡ÏŒÎ´Î¿Ï‚</option>
        </select>
        <button type="submit" class="w-full bg-primary text-white py-2 rounded-xl">Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·</button>
      </form>
    </div>
  </div>
  <div id="orderModal" class="fixed inset-0 bg-black/50 hidden items-center justify-center z-50">
    <div class="bg-white rounded-2xl p-6 shadow-strong w-full max-w-lg relative overflow-auto max-h-[90vh]">
      <button onclick="closeModal('orderModal')" class="absolute top-3 right-3 text-gray-500 hover:text-gray-700">âœ•</button>
      <h3 class="text-xl font-semibold mb-4 text-center">Î•Ï€ÎµÎ¾ÎµÏÎ³Î±ÏƒÎ¯Î± Î Î±ÏÎ±Î³Î³ÎµÎ»Î¯Î±Ï‚</h3>
      <!-- Order form fields here -->
      <button onclick="saveOrder()" class="mt-4 w-full bg-primary text-white py-2 rounded-xl">Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·</button>
    </div>
  </div>

  <script>
    // Firebase init
    firebase.initializeApp({apiKey:"AIzaSy...",authDomain:"pointregistrationapp.firebaseapp.com",projectId:"pointregistrationapp",storageBucket:"...",messagingSenderId:"...",appId:"..."});
    const db = firebase.firestore();

    function closeModal(id){document.getElementById(id).classList.add('hidden');}

    document.addEventListener("DOMContentLoaded",()=>{
      const loginForm=document.getElementById("loginForm"),loginModal=document.getElementById("loginModal"),appContent=document.getElementById("appContent"),logoutBtn=document.getElementById("logoutBtn");
      loginForm.addEventListener("submit",async e=>{e.preventDefault();const u=document.getElementById("loginUsername").value.trim(),p=document.getElementById("loginPassword").value,doc=await db.collection("admins").doc(u).get();if(doc.exists&&doc.data().password===p){loginModal.classList.add("hidden");appContent.classList.remove("hidden");initAdmin()}else alert("Î›Î¬Î¸Î¿Ï‚ Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î®ÏÎ¹Î±")});
      logoutBtn.addEventListener("click",()=>location.reload());
      document.querySelectorAll("[data-tab]").forEach(btn=>btn.addEventListener("click",()=>{document.querySelectorAll(".tab-content").forEach(s=>s.classList.add("hidden"));document.getElementById(btn.dataset.tab).classList.remove("hidden")}));
    });

    function clientCard(c){const d=document.createElement("div");d.className="relative bg-gradient-to-br from-primary-light to-primary-dark rounded-2xl p-6 shadow-strong transform hover:scale-105 transition";d.innerHTML=`<h3 class="mt-8 text-center text-xl font-semibold text-white uppercase">${c.name}</h3><div class="absolute top-3 right-3 flex space-x-2"><button onclick="openEditUser('${c.id}')" class="px-2 py-1 bg-accent text-white rounded">âœ</button><button onclick="deleteUser('${c.id}')" class="px-2 py-1 bg-danger text-white rounded">ğŸ—‘ï¸</button></div><p class="mt-2 text-white/80 text-center">username: ${c.username}</p>`;return d;}
    function productCard(p){const d=document.createElement("div");d.className="relative bg-white rounded-2xl p-6 shadow-strong";d.innerHTML=`<h3 class="text-xl font-semibold text-primary mb-2">${p.name}</h3><div class="absolute top-3 right-3 space-x-2"><button onclick="openEditProduct('${p.id}')" class="px-2 py-1 bg-accent text-white rounded">âœ</button><button onclick="deleteProduct('${p.id}')" class="px-2 py-1 bg-danger text-white rounded">ğŸ—‘ï¸</button></div><p class="text-gray-700">â‚¬${p.price.toFixed(2)}</p>`;return d;}
    function pointCard(p){const d=document.createElement("div");d.className="relative bg-white rounded-2xl p-6 shadow-strong";d.innerHTML=`<h3 class="mt-8 text-center text-xl font-semibold text-darktext uppercase">${p.name}</h3><div class="absolute top-3 right-3 space-x-2"><button onclick="openEditPoint('${p.id}','${p.name}','${p.area}')" class="px-2 py-1 bg-accent text-white rounded">âœ</button><button onclick="deletePoint('${p.id}')" class="px-2 py-1 bg-danger text-white rounded">ğŸ—‘ï¸</button></div><p class="mt-2 text-gray-500 text-sm text-center">${p.area}</p>`;return d;}
    function orderRow(o,dn){const tr=document.createElement("tr");tr.innerHTML=`<td class="px-4 py-2">${dn}</td><td class="px-4 py-2">${o.total.toFixed(2)}</td><td class="px-4 py-2">${new Date(o.timestamp.toDate()).toLocaleString()}</td><td class="px-4 py-2"><button onclick="deleteOrder('${o.id}')" class="bg-danger text-white px-2 py-1 rounded">ğŸ—‘ï¸</button></td><td><button onclick="openEditOrder('${o.id}')" class="bg-accent text-white px-2 py-1 rounded">âœ</button></td><td><button onclick="markExecuted('${o.id}')" class="bg-success text-white px-2 py-1 rounded">âœ”ï¸</button></td>`;return tr;}
    async function initAdmin(){
      document.querySelector("[data-tab='users']").click();
      db.collection("users").orderBy("name").onSnapshot(s=>{const c=document.getElementById("usersContainer");c.innerHTML="";s.docs.forEach(d=>c.appendChild(clientCard({...d.data(),id:d.id}))});
      document.getElementById("addUserBtn").onclick=()=>document.getElementById("userModal").classList.remove("hidden");
      document.getElementById("userForm").onsubmit=async e=>{e.preventDefault();await db.collection("users").add({name:document.getElementById("userName").value.trim(),username:document.getElementById("userUsername").value.trim(),role:"Î§ÏÎ®ÏƒÏ„Î·Ï‚",password:document.getElementById("userPass").value});closeModal("userModal")};
      db.collection("products").orderBy("name").onSnapshot(s=>{const c=document.getElementById("productsContainer");c.innerHTML="";s.docs.forEach(d=>c.appendChild(productCard({...d.data(),id:d.id}))});
      document.getElementById("addProductBtn").onclick=()=>document.getElementById("productModal").classList.remove("hidden");
      document.getElementById("productForm").onsubmit=async e=>{e.preventDefault();await db.collection("products").add({name:document.getElementById("productNameInput").value.trim(),price:parseFloat(document.getElementById("productPriceInput").value)});closeModal("productModal")};
      db.collection("points").orderBy("timestamp","desc").onSnapshot(s=>{const c=document.getElementById("pointsContainer");c.innerHTML="";s.docs.forEach(d=>c.appendChild(pointCard({...d.data(),id:d.id}))});
      db.collectionGroup("orders").orderBy("timestamp","desc").onSnapshot(async s=>{const tb=document.getElementById("ordersTable");tb.innerHTML="";for(const d of s.docs){const o=d.data(),pid=d.ref.parent.parent.id,pd=await d.ref.parent.parent.get();const dn=pd.exists?pd.data().name:pid;tb.append(orderRow({...o,id:d.id},dn))}});
    }
    function deleteUser(id){if(confirm("Î”Î¹Î±Î³ÏÎ±Ï†Î® Ï‡ÏÎ®ÏƒÏ„Î·;"))db.collection("users").doc(id).delete();}
    function deleteProduct(id){if(confirm("Î”Î¹Î±Î³ÏÎ±Ï†Î® Ï€ÏÎ¿ÏŠÏŒÎ½Ï„Î¿Ï‚;"))db.collection("products").doc(id).delete();}
    function deletePoint(id){if(confirm("Î”Î¹Î±Î³ÏÎ±Ï†Î® ÏƒÎ·Î¼ÎµÎ¯Î¿Ï…;"))db.collection("points").doc(id).delete();}
    function deleteOrder(id){if(confirm("Î”Î¹Î±Î³ÏÎ±Ï†Î® Ï€Î±ÏÎ±Î³Î³ÎµÎ»Î¯Î±Ï‚;"))db.collectionGroup("orders").where(firebase.firestore.FieldPath.documentId(),"==",id).get().then(s=>s.docs[0].ref.delete());}
    function openEditPoint(id,name,area){document.getElementById("pointModal").classList.remove("hidden");document.getElementById("pointNameInput").value=name;document.getElementById("pointAreaInput").value=area;document.getElementById("pointForm").onsubmit=async e=>{e.preventDefault();await db.collection("points").doc(id).update({name:document.getElementById("pointNameInput").value.trim(),area:document.getElementById("pointAreaInput").value});closeModal("pointModal")}};
    // Edit and mark executed for orders and users/products similarly...
    function openEditOrder(id){alert("Î•Ï€ÎµÎ¾ÎµÏÎ³Î±ÏƒÎ¯Î± Ï€Î±ÏÎ±Î³Î³ÎµÎ»Î¯Î±Ï‚: "+id);}
    function markExecuted(id){if(confirm("Î£Î®Î¼Î±Î½ÏƒÎ· Ï‰Ï‚ ÎµÎºÏ„ÎµÎ»ÎµÏƒÎ¼Î­Î½Î·;")){ /* update flag */ }}
  </script>
</body>
</html>
